{
  "sk_service_col" : "hold_sk",
  "pipeline_name" : "d_ms_hold_def",
  "decrypt_EncKey" : "EncKey",
  "target_table" : "d_ms_hold_def",
  "decrypt_InitVec" : "InitVec",
  "disable_reject_record_summary" : "false",
  "generate_load_ready_files" : "true",
  "optional_sk_config" : "sks = [{\n    \"table-name\" : \"l_reference_info\",\n    \"sk-col\" : \"hold_typ_sk\",\n    \"nk-col\": [\"'MS_HOLD_TYPE'\", \"type_code\"]\n}]",
  "source_table" : "iris_view.v_xxiris_om_order_holds_v",
  "enable_sk_service" : "true",
  "hash_cols" : "hold_sk",
  "sk_service_self_join" : "true",
  "create_placeholders" : "true",
  "pk_sk_info" : "{\r\n\t\"l_reference_info\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.l_reference_info\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_reference_info\",\r\n\t\t\"pk-cols\": [\"ref_info_typ\", \"ref_info_cd\"],\r\n\t\t\"sk-cols\": \"ref_info_sk\",\r\n\t\t\"order-by-dedup\": \"ref_info_desc asc\"\r\n\t},\r\n\t\"d_ms_ship_method\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.d_ms_ship_method3\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.d_ms_ship_method\",\r\n\t\t\"pk-cols\": [\"ship_mthd_cd\"],\r\n\t\t\"sk-cols\": \"ship_mthd_sk\"\r\n\t},\r\n\t\"d_ms_hold_def\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.d_ms_hold_def\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.d_ms_hold_def\",\r\n\t\t\"pk-cols\": [\"hold_id\"],\r\n\t\t\"sk-cols\": \"hold_sk\"\r\n\t},\r\n\t\"l_ms_uom\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.l_ms_uom\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_ms_uom\",\r\n\t\t\"pk-cols\": [\"uom_cd\"],\r\n\t\t\"sk-cols\": \"uom_sk\"\r\n\t},\r\n\t\"l_ms_line_status\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.l_ms_line_status\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_ms_line_status\",\r\n\t\t\"pk-cols\": [\"line_stat_cd\"],\r\n\t\t\"sk-cols\": \"line_stat_sk\"\r\n\t},\r\n\t\"l_ms_drug_genric_indicator\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.l_ms_drug_genric_indicator\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_ms_drug_genric_indicator\",\r\n\t\t\"pk-cols\": [\"drg_genric_ind\"],\r\n\t\t\"sk-cols\": \"drg_genric_ind_sk\"\r\n\t},\r\n\t\"d_ms_patient\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.d_ms_patient\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.d_ms_patient\",\r\n\t\t\"pk-cols\": [\"patient_party_id\"],\r\n\t\t\"sk-cols\": \"patient_sk\"\r\n\t},\r\n\t\"l_ms_patient_hff_rsn\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"temp.l_ms_patient_hff_rsn\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_ms_patient_hff_rsn\",\r\n\t\t\"pk-cols\": [\"hff_rsn_typ\", \"hff_rsn_desc\"],\r\n\t\t\"sk-cols\": \"hff_rsn_key\"\r\n\t}\r\n}",
  "length_rules" : "CASE WHEN (length(hold_nm) > 160) THEN 'hold_nm' WHEN (length(hold_desc) > 2000) THEN 'hold_desc' WHEN (length(hold_catgy_desc) > 100) THEN 'hold_catgy_desc' WHEN (length(mnl_intrvn_hold_flg) > 1) THEN 'mnl_intrvn_hold_flg' WHEN (length(hold_actv_start_dt) > 10) THEN 'hold_actv_start_dt' WHEN (length(hold_actv_end_dt) > 10) THEN 'hold_actv_end_dt' WHEN (length(tat_hold_exclusion_flg) > 1) THEN 'tat_hold_exclusion_flg' WHEN (length(patient_hold_flg) > 1) THEN 'patient_hold_flg'  ELSE 'pass' END",
  "reformat_rules_join" : "joins = [\r\n   {\r\n      \"fmt\":\"csv\",\r\n      \"src\":\"dbfs:/mnt/local/w_iris_hold_category.csv\",\r\n      \"join-cond\":\"in1.hold_name = upper(in0.name)\",\r\n      \"val-cols\":[\r\n         \"in1.hold_category_priority_id AS hold_category_priority_id0\",\r\n         \"in1.hold_category_desc AS hold_category_desc0\",\r\n         \"in1.manual_intervention_hold_flag AS manual_intervention_hold_flag0\",\r\n         \"in1.tat_hold_exclusion_flag AS tat_hold_exclusion_flag0\",\r\n         \"in1.patient_hold_flg AS patient_hold_flg0\"\r\n      ],\r\n      \"delimiter\": \",\"\r\n   },\r\n   {\r\n      \"fmt\":\"table\",\r\n      \"src\":\"temp.l_reference_info\",\r\n      \"join-cond\":\"in1.ref_info_cd = trim(concat(in0.type_code, 'new_ph_test26'))\",\r\n      \"val-cols\":[\r\n         \"in1.ref_info_sk as in1_hold_typ_sk\"\r\n      ],\r\n      \"filter-cond\":\"ref_info_typ == 'MS_HOLD_TYPE'\"\r\n   }\r\n]",
  "read_incremental_files_flag" : "true",
  "target_table_db" : "temp",
  "merge_logic_including_sk" : true,
  "encrypt_scope" : "ide-dbscope",
  "reformat_rules" : "{\r\n  \"hold_catgy_desc\": \"trim(hold_category_desc0)\",\r\n  \"hold_nm\": \"trim(name)\",\r\n  \"hold_catgy_priorty_id\": \"CAST(CAST(trim(hold_category_priority_id0) AS DECIMAL(38,0)) AS STRING)\",\r\n  \"hold_id\": \"CAST(CAST(hold_id AS DECIMAL(38,0)) + 27 AS STRING)\",\r\n  \"mnl_intrvn_hold_flg\": \"trim(manual_intervention_hold_flag0)\",\r\n  \"hold_typ_sk\": \"in1_hold_typ_sk\",\r\n  \"patient_hold_flg\": \"CASE WHEN (patient_hold_flg0 IS NULL) THEN 'N' ELSE patient_hold_flg0 END\",\r\n  \"hold_actv_start_dt\": \"date_format(start_date_active, 'yyyy-MM-dd')\",\r\n  \"hold_actv_end_dt\": \"CASE WHEN (end_date_active IS NULL) THEN '9999-12-31' ELSE date_format(end_date_active, 'yyyy-MM-dd') END\",\r\n  \"hold_desc\": \"ff3_encrypt_idwdata('100452542167058')\",\r\n  \"src_env_sk\": \"CAST(CAST(dxf_src_sys_id AS DECIMAL(38,0)) AS STRING)\",\r\n  \"tat_hold_exclusion_flg\": \"CASE WHEN (tat_hold_exclusion_flag0 IS NULL) THEN 'N' ELSE tat_hold_exclusion_flag0 END\",\r\n  \"hold_sk\": \"CAST(CAST(-1 AS DECIMAL(38,0)) AS STRING)\",\r\n  \"type_code\": \"concat(type_code, 'new_ph_test27')\",\r\n  \"ref_info_desc\": \"'test_val14'\"\r\n}",
  "final_table_schema" : "{\"hold_sk\": \"long\",\n\"hold_typ_sk\": \"long\",\n\"hold_id\": \"long\",\n\"hold_nm\": \"string\",\n\"hold_desc\": \"string\",\n\"hold_catgy_priorty_id\": \"int\",\n\"hold_catgy_desc\": \"string\",\n\"mnl_intrvn_hold_flg\": \"string\",\n\"hold_actv_start_dt\": \"date\",\n\"hold_actv_end_dt\": \"date\",\n\"tat_hold_exclusion_flg\": \"string\",\n\"src_env_sk\": \"int\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"run_id\": \"long\",\n\"rec_stat_cd\": \"short\",\n\"patient_hold_flg\": \"string\"}",
  "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/Prophecy/abhinav.jain@optum.com/accumulated_testing/\"\n}]",
  "default_source_blank_nulls" : "type_code",
  "primary_key" : "hold_id",
  "decrypt_scope" : "ide-dbscope",
  "dedup_rules" : "{\r\n    \"dedupType\": \"first\",\r\n    \"dedupColumns\": \"type_code, ref_info_desc\",\r\n    \"orderByColumns\": \"mnl_intrvn_hold_flg asc nulls first, ref_info_desc desc\"\r\n}",
  "accumulated_process_flag" : "true"
}