{
  "sk_service_col" : "hold_sk",
  "pipeline_name" : "d_ms_hold_def",
  "decrypt_EncKey" : "EncKey",
  "target_table" : "d_ms_hold_def",
  "decrypt_InitVec" : "InitVec",
  "disable_reject_record_summary" : "false",
  "generate_load_ready_files" : "true",
  "optional_sk_config" : "sks = [{\n    \"table-name\" : \"l_reference_info\",\n    \"sk-col\" : \"hold_typ_sk\",\n    \"nk-col\": [\"'MS_HOLD_TYPE'\", \"type_code\"]\n}]",
  "source_table" : "iris_view.v_xxiris_om_order_holds_v",
  "enable_sk_service" : "true",
  "hash_cols" : "hold_sk",
  "sk_service_self_join" : "true",
  "create_placeholders" : "true",
  "pk_sk_info" : "{\"l_reference_info\":{\"fmt\":\"table\",\"src\":\"temp.l_reference_info\",\"synapse-table\":\"orx_idw_dm_prd.l_reference_info\",\"pk-cols\":[\"ref_info_typ\",\"ref_info_cd\"],\"sk-cols\":\"ref_info_sk\"},\"d_ms_ship_method\":{\"fmt\":\"table\",\"src\":\"temp.d_ms_ship_method3\",\"synapse-table\":\"orx_idw_dm_prd.d_ms_ship_method\",\"pk-cols\":[\"ship_mthd_cd\"],\"sk-cols\":\"ship_mthd_sk\"},\"d_ms_hold_def\":{\"fmt\":\"table\",\"src\":\"temp.d_ms_hold_def\",\"synapse-table\":\"orx_idw_dm_prd.d_ms_hold_def\",\"pk-cols\":[\"hold_id\"],\"sk-cols\":\"hold_sk\"},\"l_ms_uom\":{\"fmt\":\"table\",\"src\":\"temp.l_ms_uom\",\"synapse-table\":\"orx_idw_dm_prd.l_ms_uom\",\"pk-cols\":[\"uom_cd\"],\"sk-cols\":\"uom_sk\"},\"l_ms_line_status\":{\"fmt\":\"table\",\"src\":\"temp.l_ms_line_status\",\"synapse-table\":\"orx_idw_dm_prd.l_ms_line_status\",\"pk-cols\":[\"line_stat_cd\"],\"sk-cols\":\"line_stat_sk\"},\"l_ms_drug_genric_indicator\":{\"fmt\":\"table\",\"src\":\"temp.l_ms_drug_genric_indicator\",\"synapse-table\":\"orx_idw_dm_prd.l_ms_drug_genric_indicator\",\"pk-cols\":[\"drg_genric_ind\"],\"sk-cols\":\"drg_genric_ind_sk\"},\"d_ms_patient\":{\"fmt\":\"table\",\"src\":\"temp.d_ms_patient\",\"synapse-table\":\"orx_idw_dm_prd.d_ms_patient\",\"pk-cols\":[\"patient_party_id\"],\"sk-cols\":\"patient_sk\"},\"l_ms_patient_hff_rsn\":{\"fmt\":\"table\",\"src\":\"temp.l_ms_patient_hff_rsn\",\"synapse-table\":\"orx_idw_dm_prd.l_ms_patient_hff_rsn\",\"pk-cols\":[\"hff_rsn_typ\",\"hff_rsn_desc\"],\"sk-cols\":\"hff_rsn_key\"}}",
  "length_rules" : "CASE WHEN (length(hold_nm) > 160) THEN 'hold_nm' WHEN (length(hold_desc) > 2000) THEN 'hold_desc' WHEN (length(hold_catgy_desc) > 100) THEN 'hold_catgy_desc' WHEN (length(mnl_intrvn_hold_flg) > 1) THEN 'mnl_intrvn_hold_flg' WHEN (length(hold_actv_start_dt) > 10) THEN 'hold_actv_start_dt' WHEN (length(hold_actv_end_dt) > 10) THEN 'hold_actv_end_dt' WHEN (length(tat_hold_exclusion_flg) > 1) THEN 'tat_hold_exclusion_flg' WHEN (length(patient_hold_flg) > 1) THEN 'patient_hold_flg'  ELSE 'pass' END",
  "reformat_rules_join" : "joins = [\r\n   {\r\n      \"fmt\":\"csv\",\r\n      \"src\":\"dbfs:/mnt/local/w_iris_hold_category.csv\",\r\n      \"join-cond\":\"aes_decrypt_udf(aes_encrypt_udf(in1.hold_name)) = aes_decrypt_udf(aes_encrypt_udf(upper(in0.name)))\",\r\n      \"val-cols\":[\r\n         \"in1.hold_category_priority_id AS hold_category_priority_id0\",\r\n         \"aes_encrypt_udf(in1.hold_category_desc) AS hold_category_desc0\",\r\n         \"in1.manual_intervention_hold_flag AS manual_intervention_hold_flag0\",\r\n         \"in1.tat_hold_exclusion_flag AS tat_hold_exclusion_flag0\",\r\n         \"in1.patient_hold_flg AS patient_hold_flg0\"\r\n      ]\r\n   },\r\n   {\r\n      \"fmt\":\"table\",\r\n      \"src\":\"orx_idw_dm_prd.l_reference_info\",\r\n      \"join-cond\":\"aes_encrypt_udf(in1.ref_info_cd) = aes_encrypt_udf(trim(concat(in0.type_code, 'new_ph_test18')))\",\r\n      \"val-cols\":[\r\n         \"in1.ref_info_sk as in1_hold_typ_sk\"\r\n      ],\r\n      \"filter-cond\":\"ref_info_typ == 'MS_HOLD_TYPE'\"\r\n   }\r\n]",
  "read_incremental_files_flag" : "false",
  "target_table_db" : "temp",
  "encrypt_scope" : "ide-dbscope",
  "reformat_rules" : "{\n  \"hold_catgy_desc\": \"aes_decrypt_udf('C640C202EB1E3CA8927E933FAA1F43D3247D4FF446845495B4D3E6AEDAB3BA4D339FD59070415AF657F3333F01EFD0075D065AF119048B05AAD5B96B962D180D64BB5EDD140D683C8578FE1209B84B78')\",\n  \"hold_nm\": \"aes_encrypt_udf(trim(name))\",\n  \"hold_catgy_priorty_id\": \"CAST(CAST(trim(hold_category_priority_id0) AS DECIMAL(38,0)) AS STRING)\",\n  \"hold_id\": \"CAST(CAST(hold_id AS DECIMAL(38,0))  + 535 AS STRING)\",\n  \"mnl_intrvn_hold_flg\": \"trim(manual_intervention_hold_flag0)\",\n  \"hold_typ_sk\": \"in1_hold_typ_sk\",\n  \"patient_hold_flg\": \"CASE WHEN (patient_hold_flg0 IS NULL) THEN 'N' ELSE patient_hold_flg0 END\",\n  \"hold_actv_start_dt\": \"date_format(start_date_active, 'yyyy-MM-dd')\",\n  \"hold_actv_end_dt\": \"CASE WHEN (end_date_active IS NULL) THEN '9999-12-31' ELSE date_format(end_date_active, 'yyyy-MM-dd') END\",\n  \"hold_desc\": \"trim(description)\",\n  \"src_env_sk\": \"CAST(CAST(dxf_src_sys_id AS DECIMAL(38,0)) AS STRING)\",\n  \"tat_hold_exclusion_flg\": \"CASE WHEN (tat_hold_exclusion_flag0 IS NULL) THEN 'N' ELSE tat_hold_exclusion_flag0 END\",\n  \"hold_sk\": \"CAST(CAST(-1 AS DECIMAL(38,0)) AS STRING)\",\n  \"type_code\": \"concat(type_code, 'new_ph_test18')\",\n  \"ref_info_desc\": \"'test_val12'\"\n}",
  "final_table_schema" : "{\"hold_sk\": \"long\",\n\"hold_typ_sk\": \"long\",\n\"hold_id\": \"long\",\n\"hold_nm\": \"string\",\n\"hold_desc\": \"string\",\n\"hold_catgy_priorty_id\": \"int\",\n\"hold_catgy_desc\": \"string\",\n\"mnl_intrvn_hold_flg\": \"string\",\n\"hold_actv_start_dt\": \"date\",\n\"hold_actv_end_dt\": \"date\",\n\"tat_hold_exclusion_flg\": \"string\",\n\"src_env_sk\": \"int\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"run_id\": \"long\",\n\"rec_stat_cd\": \"short\",\n\"patient_hold_flg\": \"string\"}",
  "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/mnt/local/QA_testing/Source_clean_files/clean.apps.xxiris_om_order_holds_v.20220823010101.parquet\"\n}]",
  "primary_key" : "hold_id",
  "decrypt_scope" : "ide-dbscope"
}