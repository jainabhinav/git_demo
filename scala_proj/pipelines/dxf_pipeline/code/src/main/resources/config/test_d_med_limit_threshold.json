{
  "sk_service_col" : "med_limit_thrshld_sk",
  "pipeline_name" : "d_med_limit_thrshld",
  "target_table" : "f_integ_accm_svng_claim_trx",
  "target_write_type" : "scd2",
  "source_table" : "rc15rp",
  "enable_sk_service" : "true",
  "pk_sk_info" : "{\r\n  \"d_pos_rebate_detail\" : {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_pos_rebate_detail\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_pos_rebate_detail\",\r\n    \"pk-cols\": [\r\n      \"rebate_tbl_id\", \r\n      \"ndc_lblr_cd\", \r\n      \"ndc_prod_cd\", \r\n      \"ndc_pkg_cd\",\r\n      \"dxp_seq_nbr\", \r\n      \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"pos_rebate_dtl_sk\"\r\n  },\r\n  \"l_pa_gpi_list\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"orx_idw_dm_prd.l_pa_gpi_list\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.l_pa_gpi_list\",\r\n\t\t\"pk-cols\": [\"pa_gpi_list_nm\", \"src_env_sk\"],\r\n\t\t\"sk-cols\": \"pa_gpi_list_sk\"\r\n\t},\r\n  \"d_product\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_product\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_product\",\r\n    \"pk-cols\": [\r\n      \"prod_id\",\r\n      \"prod_id_qlfr_cd\"\r\n    ],\r\n    \"sk-cols\": \"prod_sk\"\r\n  },\r\n  \"d_pos_rebate_table\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_pos_rebate_table\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_pos_rebate_table\",\r\n    \"pk-cols\": [\r\n      \"rebate_tbl_id\", \r\n      \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"rebate_tbl_sk\"\r\n  },\r\n  \"d_date\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_date\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_date\",\r\n    \"pk-cols\": [\r\n      \"cal_day_dt\",\r\n    ],\r\n    \"sk-cols\": \"dt_sk\"\r\n  },\r\n  \"d_pharmacy_network\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_pharmacy_network\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_pharmacy_network\",\r\n    \"pk-cols\": [\r\n      \"phr_ntwrk_id\",\r\n\t    \"phr_ntwrk_seq_no\"\r\n    ],\r\n    \"sk-cols\": \"ntwk_sk\"\r\n  },\r\n  \"d_plan\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_plan\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_plan\",\r\n    \"pk-cols\": [\r\n      \"pln_cd\",\r\n\t  \"pln_eff_dt\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"pln_sk\"\r\n  },\r\n  \"d_plan_pharmacy_ntwk_dtl\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_plan_pharmacy_ntwk_dtl\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_plan_pharmacy_ntwk_dtl\",\r\n    \"pk-cols\": [\r\n      \"pln_cd\",\r\n\t  \"pln_eff_dt\",\r\n\t  \"phr_ntwk_prty\",\r\n\t  \"pln_ntw_type\",\r\n\t  \"phn_phr_ntwk_id\",\r\n\t  \"phn_seq_nbr\",\r\n\t  \"pln_phr_ntwk_list_cd\",\r\n\t  \"pln_phr_ntwk_list_type\",\r\n\t  \"rx5_seq_nbr\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"pln_phr_ntwk_sk\"\r\n  },\r\n  \"l_pharmacy_network_gpi_list\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_pharmacy_network_gpi_list\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_pharmacy_network_gpi_list\",\r\n    \"pk-cols\": [\r\n      \"phr_ntwk_gpi_list_nm\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"phr_ntwk_gpi_list_nm_sk\"\r\n  },\r\n  \"l_pharmacy_network_ndc_list\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_pharmacy_network_ndc_list\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_pharmacy_network_ndc_list\",\r\n    \"pk-cols\": [\r\n      \"phr_ntwk_ndc_list_nm\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"phr_ntwk_ndc_list_nm_sk\"\r\n  },\r\n  \"d_cpn_patient_pay_gpi_dtl\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_cpn_patient_pay_gpi_dtl\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_cpn_patient_pay_gpi_dtl\",\r\n    \"pk-cols\": [\r\n      \"gpi_list_nm\",\r\n      \"gpi_id\",\r\n      \"cpn_pat_pay_gpi_seq_nbr\"\r\n    ],\r\n    \"sk-cols\": \"gpi_sk\"\r\n  },\r\n  \"d_deductible_schedule_control\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_deductible_schedule_control\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_deductible_schedule_control\",\r\n    \"pk-cols\": [\r\n      \"ded_sched_nm\",\r\n\t    \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"ded_sched_sk\"\r\n  },\r\n  \"d_cag\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_cag\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_cag\",\r\n    \"pk-cols\": [\r\n      \"carrier_id\",\r\n\t    \"account_id\",\r\n      \"employer_group_id\"\r\n    ],\r\n    \"sk-cols\": \"cag_sk\"\r\n  },\r\n  \"d_carrier_acct\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_carrier_acct\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_carrier_acct\",\r\n    \"pk-cols\": [\r\n      \"carrier_id\",\r\n\t    \"account_id\"\r\n    ],\r\n    \"sk-cols\": \"carrier_acct_sk\"\r\n  },\r\n  \"d_carrier\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_carrier\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_carrier\",\r\n    \"pk-cols\": [\r\n      \"carrier_id\"\r\n    ],\r\n    \"sk-cols\": \"carrier_sk\"\r\n  },\r\n  \"d_gpi\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_gpi\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_gpi\",\r\n    \"pk-cols\": [\r\n      \"gpi_id\"\r\n    ],\r\n    \"sk-cols\": \"gpi_sk\"\r\n  },\r\n  \"l_client_benefit\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_client_benefit\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_client_benefit\",\r\n    \"pk-cols\": [\r\n      \"client_benefit_cd\"\r\n    ],\r\n    \"sk-cols\": \"client_benefit_cd_sk\"\r\n  },\r\n  \"d_member\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_member\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_member\",\r\n    \"pk-cols\": [\r\n      \"carrier_id\",\r\n\t    \"account_id\",\r\n      \"employer_group_id\",\r\n      \"mbr_id\"\r\n    ],\r\n    \"sk-cols\": \"mbr_sk\"\r\n  },\r\n  \"d_pharmacy\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_pharmacy\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_pharmacy\",\r\n    \"pk-cols\": [\r\n      \"phr_id\"\r\n    ],\r\n    \"sk-cols\": \"phr_sk\"\r\n  },\r\n  \"l_claim_status\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_claim_status\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_claim_status\",\r\n    \"pk-cols\": [\r\n      \"claim_stat_id\"\r\n    ],\r\n    \"sk-cols\": \"claim_stat_sk\"\r\n  },\r\n  \"l_cob_indicator\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_cob_indicator\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_cob_indicator\",\r\n    \"pk-cols\": [\r\n      \"cob_ind\"\r\n    ],\r\n    \"sk-cols\": \"cob_ind_sk\"\r\n  },\r\n  \"l_generic_medispan_indicator\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_generic_medispan_indicator\",\r\n    \"pk-cols\": [\r\n      \"gnrc_mdspn_ind\"\r\n    ],\r\n    \"sk-cols\": \"gnrc_mdspn_ind_sk\"\r\n  },\r\n  \"l_drug_otc_indicator\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_drug_otc_indicator\",\r\n    \"pk-cols\": [\r\n      \"drug_rx_otc_ind\"\r\n    ],\r\n    \"sk-cols\": \"drug_rx_otc_ind_sk\"\r\n  },\r\n  \"l_prod_status_rule\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_prod_status_rule\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_prod_status_rule\",\r\n    \"pk-cols\": [\r\n      \"prod_status_rule_tbl_id\"\r\n    ],\r\n    \"sk-cols\": \"prod_status_rule_tbl_id_sk\"\r\n  },\r\n  \"l_state\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_state\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_state\",\r\n    \"pk-cols\": [\r\n      \"state_cd\"\r\n    ],\r\n    \"sk-cols\": \"st_cd_sk\"\r\n  },\r\n  \"d_prescriber_alias\": {\r\n\t\t\"fmt\": \"table\",\r\n\t\t\"src\": \"orx_idw_dm_prd.d_prescriber_alias\",\r\n\t\t\"synapse-table\": \"orx_idw_dm_prd.d_prescriber_alias\",\r\n\t\t\"pk-cols\": [\r\n\t\t\t\"pbr_id\",\r\n\t\t\t\"pbr_id_qlfr\",\r\n\t\t\t\"pbr_id_st_cd\",\r\n      \"src_env_sk\"\r\n\t\t],\r\n\t\t\"sk-cols\": \"pbr_sk\"\r\n\t},\r\n  \"l_prescriber_specialty\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_prescriber_specialty\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_prescriber_specialty\",\r\n    \"pk-cols\": [\r\n      \"pbr_spclty_cd\"\r\n    ],\r\n    \"sk-cols\": \"pbr_spclty_sk\"\r\n  },\r\n  \"l_days_of_supply\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_days_of_supply\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_days_of_supply\",\r\n    \"pk-cols\": [\r\n      \"days_of_supply_min\"\r\n    ],\r\n    \"sk-cols\": \"days_of_supply_sk\"\r\n  },\r\n  \"l_reject_code\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.l_reject_code\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.l_reject_code\",\r\n    \"pk-cols\": [\r\n      \"rej_cd\"\r\n    ],\r\n    \"sk-cols\": \"rvrsl_resp_rej_cd_sk\"\r\n  },\r\n  \"f_claim_transaction\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.f_claim_transaction\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.f_claim_transaction\",\r\n    \"pk-cols\": [\r\n      \"claim_nbr\",\r\n      \"claim_seq_nbr\",\r\n      \"claim_stat_id\",\r\n      \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"cag_sk,mbr_sk,prod_sk,carrier_sk\"\r\n  },\r\n  \"l_formulary_client_xrfe\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"prophecy_dev.l_formulary_client_xrfe\",\r\n    \"synapse-table\": \"prophecy_dev.l_formulary_client_xrfe\",\r\n    \"pk-cols\": [\r\n      \"client_id\"\r\n    ],\r\n    \"sk-cols\": \"client_xrfe_sk\"\r\n  },\r\n  \"d_call_tracking_detail\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_call_tracking_detail\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_call_tracking_detail\",\r\n    \"pk-cols\": [\r\n      \"clh_create_dt\",\r\n\t  \"clh_create_tm\",\r\n\t  \"clh_job_nbr\",\r\n\t  \"cld_type_ind\",\r\n\t  \"cld_seq_nbr\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"call_track_dtl_sk\"\r\n  },\r\n  \"d_call_tracking_header\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_call_tracking_header\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_call_tracking_header\",\r\n    \"pk-cols\": [\r\n      \"clh_create_dt\",\r\n\t  \"clh_create_tm\",\r\n\t  \"clh_job_nbr\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"call_track_hdr_sk\"\r\n  },\r\n  \"d_mmo_mbr_medlmt_ovrd\": {\r\n    \"fmt\": \"table\",\r\n    \"src\": \"orx_idw_dm_prd.d_mmo_mbr_medlmt_ovrd\",\r\n    \"synapse-table\": \"orx_idw_dm_prd.d_mmo_mbr_medlmt_ovrd\",\r\n    \"pk-cols\": [\r\n      \"mbr_id\",\r\n\t  \"carrier_id\",\r\n\t  \"account_id\",\r\n\t  \"employer_group_id\",\r\n\t  \"mmo_prior_auth_nbr\",\r\n\t  \"src_env_sk\"\r\n    ],\r\n    \"sk-cols\": \"mbr_id\"\r\n  }\r\n}",
  "length_rules" : "CASE WHEN (length(dur_tbl_nm) > 8) THEN 'dur_tbl_nm' WHEN (length(dur_srvc_nm) > 8) THEN 'dur_srvc_nm' WHEN (length(med_limit) > 8) THEN 'med_limit' WHEN (length(med_limit_resp) > 1) THEN 'med_limit_resp' WHEN (length(med_limit_msg_cd) > 10) THEN 'med_limit_msg_cd' WHEN (length(med_limit_thrshld_qual) > 1) THEN 'med_limit_thrshld_qual' WHEN (length(med_limit_new_mbr) > 1) THEN 'med_limit_new_mbr' WHEN (length(med_limit_ir_flg) > 1) THEN 'med_limit_ir_flg'  ELSE 'pass' END",
  "target_table_db" : "prophecy_dev",
  "pk_sk_col_from_metadata_table" : true,
  "reformat_rules" : "{\"med_limit_from_dt\":\"to_timestamp(coalesce(CASE WHEN (array_contains(array(3, 4, 5, 6, 7), length(trim(CAST(AMC2DT AS STRING)))) AND (NOT (to_timestamp(trim(CAST((19000000 + CAST(trim(CAST(AMC2DT AS STRING)) AS STRING)) AS LONG)), 'yyyyMMdd') IS NULL))) THEN trim(CAST((19000000 + CAST(trim(CAST(AMC2DT AS STRING)) AS STRING)) AS LONG)) END, CASE WHEN (array_contains(array(8), length(trim(CAST(AMC2DT AS STRING)))) AND (NOT (to_timestamp(trim(CAST(AMC2DT AS STRING)), 'yyyyMMdd') IS NULL))) THEN trim(CAST(AMC2DT AS STRING)) END, '19000101'),'yyyyMMdd')\",\"med_limit_ir_flg\":\"amk9aw\",\"med_limit_msg_cd\":\"amdqvg\",\"dur_srvc_nm\":\"amnkcd\",\"med_limit_phr_thrshld\":\"CAST(amk2bs AS DECIMAL(38,0))\",\"med_limit_resp\":\"amh8au\",\"med_limit_thrshld_qual\":\"ammwav\",\"med_limit_new_mbr\":\"amkkaw\",\"med_limit_pbr_thrshld\":\"CAST(amf8bs AS DECIMAL(38,0))\",\"dur_tbl_nm\":\"amnxcd\",\"med_limit\":\"CAST(CAST(amf5bs AS DECIMAL(8,2)) AS STRING)\",\"src_env_sk\":\"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\"med_limit_thrshld_sk\":\"CAST(-1 AS DECIMAL(38,0))\",\"med_limit_thru_dt\":\"to_timestamp(coalesce(CASE WHEN (array_contains(array(3, 4, 5, 6, 7), length(trim(CAST(AMBMDT AS STRING)))) AND (NOT (to_timestamp(trim(CAST((19000000 + CAST(trim(CAST(AMBMDT AS STRING)) AS STRING)) AS LONG)), 'yyyyMMdd') IS NULL))) THEN trim(CAST((19000000 + CAST(trim(CAST(AMBMDT AS STRING)) AS STRING)) AS LONG)) END, CASE WHEN (array_contains(array(8), length(trim(CAST(AMBMDT AS STRING)))) AND (NOT (to_timestamp(trim(CAST(AMBMDT AS STRING)), 'yyyyMMdd') IS NULL))) THEN trim(CAST(AMBMDT AS STRING)) END, '19000101'),'yyyyMMdd')\"}",
  "final_table_schema" : "{\"med_limit_thrshld_sk\": \"long\",\n\"dur_tbl_nm\": \"string\",\n\"dur_srvc_nm\": \"string\",\n\"med_limit\": \"decimal(7, 2)\",\n\"med_limit_resp\": \"string\",\n\"med_limit_msg_cd\": \"string\",\n\"med_limit_pbr_thrshld\": \"short\",\n\"med_limit_phr_thrshld\": \"short\",\n\"med_limit_thrshld_qual\": \"string\",\n\"med_limit_new_mbr\": \"string\",\n\"med_limit_ir_flg\": \"string\",\n\"med_limit_from_dt\": \"timestamp\",\n\"med_limit_thru_dt\": \"timestamp\",\n\"src_env_sk\": \"long\",\n\"rec_stat_cd\": \"short\",\n\"run_id\": \"long\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\"}",
  "source_path" : "srcs = [\n  {\n    \"fmt\": \"query\",\n    \"src\": \"SELECT rc15rp.amnxcd, rc15rp.amnkcd, rc15rp.amf5bs, rc15rp.amh8au, rc15rp.amdqvg, rc15rp.amf8bs, rc15rp.amk2bs, rc15rp.ammwav, rc15rp.amkkaw, rc15rp.amk9aw, rc15rp.amakvn, rc15rp.amc2dt, rc15rp.amadtm, rc15rp.amalvn, rc15rp.amadvn, rc15rp.ambmdt, rc15rp.amabtm, rc15rp.amaevn FROM rxclaims.rc15rp  rc15rp   where (rc15rp.amnxcd,rc15rp.amnkcd,rc15rp.amf5bs,rc15rp.amh8au,rc15rp.amkkaw,rc15rp.amk9aw) in (select rc15rp_subquery.amnxcd, rc15rp_subquery.amnkcd, min(rc15rp_subquery.amf5bs), rc15rp_subquery.amh8au, rc15rp_subquery.amkkaw, rc15rp_subquery.amk9aw from rxclaims.rc15rp rc15rp_subquery group by rc15rp_subquery.amnxcd, rc15rp_subquery.amnkcd, rc15rp_subquery.amh8au, rc15rp_subquery.amkkaw, rc15rp_subquery.amk9aw) and to_date(rc15rp.UPDATE_TIMESTAMP) <= '2023-10-31'\"\n  }\n]",
  "primary_key" : "dur_tbl_nm,dur_srvc_nm,med_limit_resp,med_limit_new_mbr,med_limit_ir_flg,med_limit_from_dt,src_env_sk",
  "read_incremental_files_flag" : "false",
  "debug_flag" : true
}