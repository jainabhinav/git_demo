{
  "sk_service_col" : "hold_sk",
  "pipeline_name" : "process-d_ms_hold_def",
  "target_table" : "d_ms_hold_def2",
  "optional_sk_config" : "sks = [{\r\n    \"table-name\" : \"l_reference_info\",\r\n    \"sk-col\" : \"hold_typ_sk\",\r\n    \"nk-col\": [\"'MS_HOLD_TYPE'\", \"trim(type_code)\"]\r\n}]",
  "source_table" : "xxiris_om_order_holds_v",
  "enable_sk_service" : "true",
  "create_placeholders" : "true",
  "length_rules" : "CASE WHEN (length(hold_nm) > 160) THEN 'hold_nm' WHEN (length(hold_desc) > 2000) THEN 'hold_desc' WHEN (length(hold_catgy_desc) > 100) THEN 'hold_catgy_desc' WHEN (length(mnl_intrvn_hold_flg) > 1) THEN 'mnl_intrvn_hold_flg' WHEN (length(hold_actv_start_dt) > 8) THEN 'hold_actv_start_dt' WHEN (length(hold_actv_end_dt) > 8) THEN 'hold_actv_end_dt' WHEN (length(tat_hold_exclusion_flg) > 1) THEN 'tat_hold_exclusion_flg' WHEN (length(patient_hold_flg) > 1) THEN 'patient_hold_flg'  ELSE 'pass' END",
  "reformat_rules_join" : "joins = [{\r\n\t\"fmt\": \"csv\",\r\n\t\"src\": \"dbfs:/mnt/local/w_iris_hold_category.csv\",\r\n\t\"join-cond\": \"in1.hold_name = upper(in0.name)\",\r\n\t\"val-cols\": [\"in1.hold_category_priority_id AS hold_category_priority_id0\", \"in1.hold_category_desc AS hold_category_desc0\", \"in1.manual_intervention_hold_flag AS manual_intervention_hold_flag0\", \"in1.tat_hold_exclusion_flag AS tat_hold_exclusion_flag0\", \"in1.patient_hold_flg AS patient_hold_flg0\"]\r\n}, {\r\n\t\"fmt\": \"table\",\r\n\t\"src\": \"orx_idw_dm_prd.l_reference_info\",\r\n\t\"join-cond\": \"in1.ref_info_cd = trim(in0.type_code)\",\r\n\t\"val-cols\": [\"in1.ref_info_sk as in1_hold_typ_sk\"],\r\n\t\"filter-cond\": \"ref_info_typ == 'MS_HOLD_TYPE'\"\r\n}]",
  "read_incremental_files_flag" : "false",
  "target_table_db" : "temp",
  "reformat_rules" : "{\r\n\t\"hold_catgy_desc\": \"trim(hold_category_desc0)\",\r\n\t\"hold_nm\": \"trim(name)\",\r\n\t\"hold_catgy_priorty_id\": \"CAST(trim(hold_category_priority_id0) AS DECIMAL(38,0))\",\r\n\t\"hold_id\": \"CAST(hold_id AS DECIMAL(38,0))\",\r\n\t\"mnl_intrvn_hold_flg\": \"trim(manual_intervention_hold_flag0)\",\r\n\t\"hold_typ_sk\": \"in1_hold_typ_sk\",\r\n\t\"patient_hold_flg\": \"CASE WHEN (patient_hold_flg0 IS NULL) THEN 'N' ELSE patient_hold_flg0 END\",\r\n\t\"hold_actv_start_dt\": \"date_format(to_timestamp(start_date_active, 'yyyyMMddHHmmss'), 'yyyyMMdd')\",\r\n\t\"hold_actv_end_dt\": \"CASE WHEN (date_format(to_timestamp(end_date_active, 'yyyyMMddHHmmss'), 'yyyyMMdd') IS NULL) THEN '99991231' ELSE date_format(to_timestamp(end_date_active, 'yyyyMMddHHmmss'), 'yyyyMMdd') END\",\r\n\t\"hold_desc\": \"trim(description)\",\r\n\t\"src_env_sk\": \"CAST(dxf_src_sys_id AS DECIMAL(38,0))\",\r\n\t\"tat_hold_exclusion_flg\": \"CASE WHEN (tat_hold_exclusion_flag0 IS NULL) THEN 'N' ELSE tat_hold_exclusion_flag0 END\",\r\n\t\"hold_sk\": \"CAST(-1 AS DECIMAL(38,0))\"\r\n}",
  "final_table_schema" : "{\"hold_sk\": \"long\",\n\"hold_typ_sk\": \"long\",\n\"hold_id\": \"long\",\n\"hold_nm\": \"string\",\n\"hold_desc\": \"string\",\n\"hold_catgy_priorty_id\": \"int\",\n\"hold_catgy_desc\": \"string\",\n\"mnl_intrvn_hold_flg\": \"string\",\n\"hold_actv_start_dt\": \"date\",\n\"hold_actv_end_dt\": \"date\",\n\"tat_hold_exclusion_flg\": \"string\",\n\"patient_hold_flg\": \"string\",\n\"src_env_sk\": \"int\",\n\"rec_stat_cd\": \"short\",\n\"run_id\": \"long\",\n\"update_uid\": \"string\",\n\"update_ts\": \"timestamp\",\n\"insert_uid\": \"string\",\n\"insert_ts\": \"timestamp\"}",
  "source_path" : "srcs = [{\n    \"fmt\" : \"parquet\",\n    \"src\" : \"dbfs:/mnt/local/QA_testing/Source_clean_files/clean.apps.xxiris_om_order_holds_v.20220823010101.parquet\"\n}]",
  "primary_key" : "hold_id"
}